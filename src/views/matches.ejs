<!DOCTYPE html>
<html>
  <%- include('partials/head.ejs', {pageTitle: "Matches"}) %>
  <body>
    <%- include('partials/nav.ejs') %> <% function matchTable(title, doFilterFinished) { %>
    <div class="container">
      <h1 class="header"><%= title %></h1>
      <table>
        <% matches.filter(match=>((doFilterFinished===match.isFinished)) ).forEach(function(match){
        %>
        <tr>
          <td>
            <a class="btn" href="/matches/<%= match._id %>">
              <%= match.startedAt?.toLocaleString() %>
            </a>
          </td>
          <% for (const playerid of match.players) { const player = players.get(playerid.toString()); %>
          <td>
            <%- (match.currentPlayerId != playerid) ? player?.name : "<b>"+player?.name+"</b>"; %>
          </td>
          <% }; %>
          <td><%= match.moveCount %></td>
          <td><%= match.lastMoveAt?.toLocaleTimeString() %></td>
          <td><%= match.id %></td>
        </tr>
        <% }); %>
      </table>
    </div>
    <% }; %> <%= matchTable("Ongoing Matches", false); %><%= matchTable("Finished Matches", true);
    %>
  </body>
</html>
